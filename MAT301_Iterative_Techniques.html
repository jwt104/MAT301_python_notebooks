
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Iterative Solutions to Equations &#8212; MAT301 Numerical Methods</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Numerical Integration" href="MAT301_Numerical_Integration.html" />
    <link rel="prev" title="Introduction to Python" href="MAT301_Python_Intro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/Abertay_Uni_Black.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">MAT301 Numerical Methods</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Welcome to MAT301 Numerical Methods with Python
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="MAT301_Python_Intro.html">
   Introduction to Python
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Iterative Solutions to Equations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="MAT301_Numerical_Integration.html">
   Numerical Integration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="MAT301_DifferentialEquationSolving1.html">
   Differential Equation Solving 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="MAT301_DifferentialEquationSolving2.html">
   Differential Equation Solving 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="MAT301_DifferentialEquationSolving3.html">
   Differential Equation Solving 3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="outro.html">
   Summary
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/MAT301_Iterative_Techniques.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FMAT301_Iterative_Techniques.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/MAT301_Iterative_Techniques.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#motivation">
   Motivation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#setting-up-libraries">
     Setting up Libraries
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simple-iteration">
   Simple Iteration
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#iteration-using-loops">
   Iteration Using Loops
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#newton-raphson-iteration">
   Newton-Raphson Iteration
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#python-for-mathematics-science">
   Python for mathematics/science
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#other-examples">
   Other Examples:
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Iterative Solutions to Equations</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#motivation">
   Motivation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#setting-up-libraries">
     Setting up Libraries
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simple-iteration">
   Simple Iteration
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#iteration-using-loops">
   Iteration Using Loops
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#newton-raphson-iteration">
   Newton-Raphson Iteration
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#python-for-mathematics-science">
   Python for mathematics/science
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#other-examples">
   Other Examples:
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="iterative-solutions-to-equations">
<h1>Iterative Solutions to Equations<a class="headerlink" href="#iterative-solutions-to-equations" title="Permalink to this headline">¶</a></h1>
<p>Notebook to implement iterative techinques elements of Abertay University undergrad course MAT301 (JT, 2022).</p>
<div class="section" id="motivation">
<h2>Motivation<a class="headerlink" href="#motivation" title="Permalink to this headline">¶</a></h2>
<p>The roots of a function are locations/values which make that function equal zero.
As the name suggests, the roots of a function are often one of the most important properties. Finding the roots of functions is important in many engineering applications such as signal processing and optimization.</p>
<p>You have already seen root-finding in action in MAT201: calculating the parameter value when equating a ray with an object requires root-finding. To do this we applied the very common root-finding strategy that you are already familiar with:</p>
<p>For a quadratic function with the form <span class="math notranslate nohighlight">\(f(x) = ax^2 + bx + c\)</span>, the ‘’quadratic formula,’’</p>
<div class="math notranslate nohighlight">
\[
x_r=\frac{-b\pm\sqrt{b^2-4ac}}{2a},
\]</div>
<p>evaluates the root(s) of the function, <span class="math notranslate nohighlight">\(x_r\)</span>, exactly (noting that there may be zero, one or two real solutions of this equation). The quadratic formula is a rare example of root-finding with a simple solution; most other types of function require novel ways to identify roots. As computational power has significantly grown in recent years, so too have iterative ways to identify roots which take advantage of computational resources and procedures.</p>
<p>We will here discuss several iterative techinques to identify roots of equations. When testing some of these tools, we may use quadratic functions, in order to compare exact and approximate solutions.</p>
<div class="section" id="setting-up-libraries">
<h3>Setting up Libraries<a class="headerlink" href="#setting-up-libraries" title="Permalink to this headline">¶</a></h3>
<p>As always, we’ll make use of some clever Python tools for plotting and maths, so our first step is to load in the libraries that store these tools:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">math</span> 
<span class="kn">import</span> <span class="nn">sys</span>
<span class="o">!{</span>sys.executable<span class="o">}</span> -m pip install termcolor
<span class="kn">from</span> <span class="nn">termcolor</span> <span class="kn">import</span> <span class="n">colored</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Yellow">DEPRECATION: Configuring installation scheme with distutils config files is deprecated and will no longer work in the near future. If you are using a Homebrew or Linuxbrew Python, please see discussion at https://github.com/Homebrew/homebrew-core/issues/76621</span>

</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: termcolor in /Users/jamesthrelfall/Library/Python/3.9/lib/python/site-packages (2.2.0)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Yellow">DEPRECATION: Configuring installation scheme with distutils config files is deprecated and will no longer work in the near future. If you are using a Homebrew or Linuxbrew Python, please see discussion at https://github.com/Homebrew/homebrew-core/issues/76621</span>

<span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> A new release of pip available: <span class=" -Color -Color-Red">22.3.1</span> -&gt; <span class=" -Color -Color-Green">23.0.1</span>
<span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> To update, run: <span class=" -Color -Color-Green">/usr/local/opt/python@3.9/bin/python3.9 -m pip install --upgrade pip</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="simple-iteration">
<h2>Simple Iteration<a class="headerlink" href="#simple-iteration" title="Permalink to this headline">¶</a></h2>
<p>In the lectures, we have encountered our first approach to tackling problems in the form <span class="math notranslate nohighlight">\(f(x)=0\)</span>: <strong>simple iteration</strong>.</p>
<p>Briefly, simple iteration requires us to rewrite the function in a form with a single dependent variable <span class="math notranslate nohighlight">\(x\)</span> on the left hand side, i.e.</p>
<div class="math notranslate nohighlight">
\[
x=F(x).
\]</div>
<p>There may also be several different forms for <span class="math notranslate nohighlight">\(F(x)\)</span> per equation.</p>
<p>In the lectures, we examined this technique using the quadratic equation</p>
<div class="math notranslate nohighlight">
\[
x^2-3x+1=0,
\]</div>
<p>which has two possible forms of <span class="math notranslate nohighlight">\(F(x)\)</span>:</p>
<div class="math notranslate nohighlight">
\[
F_1(x)=\frac{1}{3}\left(x^2+1\right)~~~~{\rm{and}}~~~~ F_2(x)=3-\frac{1}{x}.
\]</div>
<p>Lets start by defining some functions to return values according to these equations for a given <span class="math notranslate nohighlight">\(x\)</span>-value:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">F1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">result</span><span class="o">=</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">/</span> <span class="mf">3.0</span>
    <span class="k">return</span> <span class="n">result</span>
<span class="k">def</span> <span class="nf">F2</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">result</span><span class="o">=</span><span class="mf">3.0</span> <span class="o">-</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">x</span>
    <span class="k">return</span> <span class="n">result</span>     
</pre></div>
</div>
</div>
</div>
<p>We want to:</p>
<ul class="simple">
<li><p>start at a particular value of <span class="math notranslate nohighlight">\(x\)</span>,</p></li>
<li><p>calculate <span class="math notranslate nohighlight">\(F(x)\)</span> which then becomes the next value of <span class="math notranslate nohighlight">\(x\)</span>,</p></li>
<li><p>repeat the process many times.</p></li>
</ul>
<p>Lets try applying the first few steps, with an initial guess of <span class="math notranslate nohighlight">\(x=1\)</span>. Using the first function <span class="math notranslate nohighlight">\(F_1\)</span>, we see:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x0</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">F1</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">F1</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
<span class="n">x3</span> <span class="o">=</span> <span class="n">F1</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
<span class="n">x4</span> <span class="o">=</span> <span class="n">F1</span><span class="p">(</span><span class="n">x3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">x4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0 0.6666666666666666 0.48148148148148145 0.41060813900320076 0.389533014605224
</pre></div>
</div>
</div>
</div>
<p>As stated in the lectures, this appears to be converging, but its not clear how far we are from convergence.</p>
<p>Lets try our second initial guess, <span class="math notranslate nohighlight">\(x=3\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x0</span> <span class="o">=</span> <span class="mf">3.0</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">F1</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">F1</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
<span class="n">x3</span> <span class="o">=</span> <span class="n">F1</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
<span class="n">x4</span> <span class="o">=</span> <span class="n">F1</span><span class="p">(</span><span class="n">x3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">x4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.0 3.3333333333333335 4.037037037037037 5.76588934613626 11.41515998396254
</pre></div>
</div>
</div>
</div>
<p>As per the lectures, this looks to be diverging. Moving on to the second function <span class="math notranslate nohighlight">\(F_2\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x0</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">F2</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">F2</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
<span class="n">x3</span> <span class="o">=</span> <span class="n">F2</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
<span class="n">x4</span> <span class="o">=</span> <span class="n">F2</span><span class="p">(</span><span class="n">x3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">x4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0 2.0 2.5 2.6 2.6153846153846154
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x0</span> <span class="o">=</span> <span class="mf">3.0</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">F2</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">F2</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
<span class="n">x3</span> <span class="o">=</span> <span class="n">F2</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
<span class="n">x4</span> <span class="o">=</span> <span class="n">F2</span><span class="p">(</span><span class="n">x3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">x4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.0 2.6666666666666665 2.625 2.619047619047619 2.618181818181818
</pre></div>
</div>
</div>
</div>
<p>Once again we seem to see <span class="math notranslate nohighlight">\(F_2\)</span> converging upon a solution when <span class="math notranslate nohighlight">\(x_0=1\)</span> but also converging upon the same solution when <span class="math notranslate nohighlight">\(x_0=3\)</span>.</p>
<hr class="docutils" />
<p>We’ll now explore the test for <strong>convergence</strong>. Remember again from the lectures that a condition for convergence using simple iteration is:</p>
<div class="math notranslate nohighlight">
\[
\left|F'(x)\right|\lt 1,
\]</div>
<p>so we need to test this criteria as we iterate to make sure that we’re not carrying out the calculation unecessarily.</p>
<p>In order to test this, lets create two new functions containing the derivative of the functions <span class="math notranslate nohighlight">\(F_1'\)</span> and <span class="math notranslate nohighlight">\(F_2'\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">dF1dx</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">/</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">x</span>
    <span class="k">return</span> <span class="n">result</span>
<span class="k">def</span> <span class="nf">dF2dx</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">x</span> <span class="o">/</span> <span class="n">x</span>
    <span class="k">return</span> <span class="n">result</span>   
</pre></div>
</div>
</div>
</div>
<p>We have evaluated these derivatives using our mathematical knowledge, but could in principle evaluate these numerically too. We can perform a quick check by evaluating <span class="math notranslate nohighlight">\(F'(x_0)\)</span> for both functions:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp</span><span class="o">=</span><span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">dF1dx</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dF1dx</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dF2dx</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dF2dx</span><span class="p">(</span><span class="mf">3.0</span><span class="p">))]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">temp</span><span class="p">:</span>
  <span class="n">mycol</span><span class="o">=</span><span class="s1">&#39;red&#39;</span>
  <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1">#if condition met, switch color to green</span>
    <span class="n">mycol</span><span class="o">=</span><span class="s1">&#39;green&#39;</span> 
  <span class="nb">print</span><span class="p">(</span><span class="n">colored</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">mycol</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6666666666666666
2.0
1.0
0.1111111111111111
</pre></div>
</div>
</div>
</div>
<p>We can see from this that we would only expect convergence using <span class="math notranslate nohighlight">\(F_1\)</span> when <span class="math notranslate nohighlight">\(x=1\)</span> and <span class="math notranslate nohighlight">\(F_2\)</span> when <span class="math notranslate nohighlight">\(x=3\)</span>.</p>
</div>
<div class="section" id="iteration-using-loops">
<h2>Iteration Using Loops<a class="headerlink" href="#iteration-using-loops" title="Permalink to this headline">¶</a></h2>
<p>So far, we’ve effectively only used Python as a simple calculator. Python (and other languages) are far more powerful and can potentially check the derivative for convergence/divergence each time an iteration occurs. We can also build in a test of the difference between the latest iteration and previous values in order to not perform the calculation too many times. One could, in principle, combine all of these steps together in the following way:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="c1">#initial function guess</span>
<span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-5</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">)):</span>  <span class="c1">#performing a maximum of 50 iterations for safety</span>
    <span class="k">if</span> <span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">dF1dx</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)):</span>  <span class="c1">#if divergence expected</span>
      <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;divergent&#39;</span><span class="p">)</span>
      <span class="k">break</span>
    <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">F1</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>  <span class="c1">#using F1</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>              <span class="c1">#increment i</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">):</span>  <span class="c1">#is the new solution different?</span>
      <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;converged&#39;</span><span class="p">)</span>
      <span class="k">break</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;no. of steps:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s2">&quot;     final x:&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>converged
no. of steps: 11      final x: 0.38196810192991765
</pre></div>
</div>
</div>
</div>
<p>In the above code, we create a list of <span class="math notranslate nohighlight">\(x\)</span> values, and place our initial guess for <span class="math notranslate nohighlight">\(x\)</span> at the start. The code generates new values in the list, provided a tolerance between successive iterations differs by more than some user defined value (in order to not repeat steps without gaining any extra accuracy).</p>
<p>We can see with this simple loop that it takes 11 steps from <span class="math notranslate nohighlight">\(x_0\)</span>=1 to determine the root of the F1 equation to 5dp accuracy. If we shift the initial guess for <span class="math notranslate nohighlight">\(x\)</span> to be 3, and repeat the calculation, the “if” statement within the loop detects that the solution is divergent before we carry out any more iterations:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">)):</span>  <span class="c1">#performing a maximum of 50 iterations for safety</span>
    <span class="k">if</span> <span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">dF1dx</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)):</span>  <span class="c1">#if divergence expected</span>
      <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;divergent&#39;</span><span class="p">)</span>
      <span class="k">break</span>
    <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">F1</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>  <span class="c1">#using F1</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">):</span>  <span class="c1">#is the new solution different?</span>
      <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;converged&#39;</span><span class="p">)</span>
      <span class="k">break</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;no. of steps:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s2">&quot;     final x:&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>divergent
no. of steps: 1      final x: 3.0
</pre></div>
</div>
</div>
</div>
<p>Switching from <span class="math notranslate nohighlight">\(F_1\)</span> to <span class="math notranslate nohighlight">\(F_2\)</span> in the loop reflects the results we saw earlier (and in the lectures):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">)):</span>  <span class="c1">#performing a maximum of 50 iterations for safety</span>
    <span class="k">if</span> <span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">dF2dx</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)):</span>  <span class="c1">#if divergence expected</span>
      <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;divergent&#39;</span><span class="p">)</span>
      <span class="k">break</span>
    <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">F2</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>  <span class="c1">#using F2</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">):</span>  <span class="c1">#is the new solution different?</span>
      <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;converged&#39;</span><span class="p">)</span>
      <span class="k">break</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;no. of steps:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s2">&quot;     final x:&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>converged
no. of steps: 9      final x: 2.6180327868852458
</pre></div>
</div>
</div>
</div>
<p>Try varying the tolerance and seeing how many iterations the code takes to achieve convergence.</p>
</div>
<div class="section" id="newton-raphson-iteration">
<h2>Newton-Raphson Iteration<a class="headerlink" href="#newton-raphson-iteration" title="Permalink to this headline">¶</a></h2>
<p>Newton-Raphson (also sometimes known as Newton’s method) is an iterative technique which rapidly approximates the roots of a real-valued function. It is fast and efficient, yet relatively easy to understand and is in common use in many different practical applications.</p>
<p>The function we want to work with, <span class="math notranslate nohighlight">\(f(x)\)</span>, must be smooth and continuous; let us define <span class="math notranslate nohighlight">\(x_r\)</span> as an unknown root of <span class="math notranslate nohighlight">\(f(x)\)</span>. We could make an initial guess <span class="math notranslate nohighlight">\(x_0\)</span> for the value of <span class="math notranslate nohighlight">\(x_r\)</span>. Unless <span class="math notranslate nohighlight">\(x_0\)</span> is a very lucky guess, <span class="math notranslate nohighlight">\(f(x_0)\)</span> will not be a root. If we don’t find the root, we want our next guess, <span class="math notranslate nohighlight">\(x_1\)</span>, to be an improvement on <span class="math notranslate nohighlight">\(x_0\)</span> (i.e., closer to <span class="math notranslate nohighlight">\(x_r\)</span> than <span class="math notranslate nohighlight">\(x_0\)</span>). If we assume that <span class="math notranslate nohighlight">\(x_0\)</span> is “close enough” to <span class="math notranslate nohighlight">\(x_r\)</span>, then we can improve upon it by taking the linear approximation of <span class="math notranslate nohighlight">\(f(x)\)</span> around <span class="math notranslate nohighlight">\(x_0\)</span>, which is a line, and finding the intersection of this line with the x-axis. Written out, the linear approximation of <span class="math notranslate nohighlight">\(f(x)\)</span> around <span class="math notranslate nohighlight">\(x_0\)</span> is <span class="math notranslate nohighlight">\(f(x) \approx f(x_0) + f^{\prime}(x_0)(x-x_0)\)</span>. Using this approximation, we find <span class="math notranslate nohighlight">\(x_1\)</span> such that <span class="math notranslate nohighlight">\(f(x_1) = 0\)</span>. Plugging these values into the linear approximation results in the equation</p>
<div class="math notranslate nohighlight">
\[
0 = f(x_0) + f^{\prime}(x_0)(x_1-x_0),
\]</div>
<p>which when solved for <span class="math notranslate nohighlight">\(x_1\)</span> is
$<span class="math notranslate nohighlight">\(
x_1 = x_0 - \frac{f(x_0)}{f^{\prime}(x_0)}.
\)</span>$</p>
<p>An illustration of how this linear approximation improves an initial guess is shown in the following figure.</p>
<img src="https://pythonnumericalmethods.berkeley.edu/_images/19.04.01-Newton-step.png" alt="Newton Step" title="Illustration of Newton step for a smooth function, g(x)." width="400"/>
<p>Written generally, a <strong>Newton step</strong> computes an improved guess, <span class="math notranslate nohighlight">\(x_i\)</span>, using a previous guess <span class="math notranslate nohighlight">\(x_{i-1}\)</span>, and is given by the equation</p>
<div class="math notranslate nohighlight">
\[
x_i = x_{i-1} - \frac{g(x_{i-1})}{g^{\prime}(x_{i-1})}.
\]</div>
<p>The <strong>Newton-Raphson Method</strong> of finding roots iterates Newton steps from <span class="math notranslate nohighlight">\(x_0\)</span> until the error is less than the tolerance.</p>
<p>Lets return to our earlier function</p>
<div class="math notranslate nohighlight">
\[
x^2-3x+1=0.
\]</div>
<p>Instead of the simple iterative approach, we can define a function for this expression, and one for its derivative.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fnr</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">result</span>
<span class="k">def</span> <span class="nf">dfnrdx</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">3</span> 
    <span class="k">return</span> <span class="n">result</span>  
</pre></div>
</div>
</div>
</div>
<p>Now we can calculate each iteration of x based on the previous value and the calls to our two functions. Lets do this for four iterations:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">fnr</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">dfnrdx</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">fnr</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">dfnrdx</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">fnr</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="n">dfnrdx</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
<span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">fnr</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">/</span> <span class="n">dfnrdx</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
<span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">-</span> <span class="n">fnr</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span> <span class="o">/</span> <span class="n">dfnrdx</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
<span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">fnr</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">dfnrdx</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">fnr</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">dfnrdx</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">fnr</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="n">dfnrdx</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
<span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">fnr</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">/</span> <span class="n">dfnrdx</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
<span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">-</span> <span class="n">fnr</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span> <span class="o">/</span> <span class="n">dfnrdx</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1.0, 0.0, 0.3333333333333333, 0.38095238095238093, 0.3819655521783181, 0.3819660112500109]
[3.0, 2.6666666666666665, 2.619047619047619, 2.618034447821682, 2.618033988749989, 2.618033988749895]
</pre></div>
</div>
</div>
</div>
<p>We can see that this method rapidly converges upon the two roots identified earlier, without needing to worry about divergent solutions.</p>
<p>Programmers hate unecessarily repeating instructions to a computer - much of what we wrote earlier is simply a repetition of the previous line, so we could simply have the computer repeat that instruction in a loop and stop when the difference between one solution and the next is within a set tolerance:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-5</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">)):</span>  <span class="c1">#performing a maximum of 50 iterations for safety</span>
    <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">fnr</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="n">dfnrdx</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>  <span class="c1">#using F2</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">):</span>  <span class="c1">#is the new solution different?</span>
      <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;converged&#39;</span><span class="p">)</span>
      <span class="k">break</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ROOT1: no. of steps:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s2">&quot;     final x:&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">)):</span>  <span class="c1">#performing a maximum of 50 iterations for safety</span>
    <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">fnr</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="n">dfnrdx</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>  <span class="c1">#using F2</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">):</span>  <span class="c1">#is the new solution different?</span>
      <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;converged&#39;</span><span class="p">)</span>
      <span class="k">break</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ROOT2: no. of steps:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s2">&quot;     final x:&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>converged
ROOT1: no. of steps: 6      final x: 0.3819660112500109
converged
ROOT2: no. of steps: 5      final x: 2.618033988749989
</pre></div>
</div>
</div>
</div>
<p>Note that the number of steps taken by Newton-Raphson is far less than the Simple Iteration scheme. As noted in lectures, if there is a root, this scheme converges to the desired degree of accuracy relatively quickly, but still depends (to an extent) on the initial guesses for where the roots are.</p>
</div>
<div class="section" id="python-for-mathematics-science">
<h2>Python for mathematics/science<a class="headerlink" href="#python-for-mathematics-science" title="Permalink to this headline">¶</a></h2>
<p>Python is a really clever language, and lots of equally clever people have extended it, adding libraries to carry out an incredible number of difficult and complicated tasks. One of those libraries, <em>scipy</em>, incorporates a root solver, <em>fsolve</em>. You can find more information about the documentation <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.fsolve.html">here</a>.
Let’s call the library:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">fsolve</span>
</pre></div>
</div>
</div>
</div>
<p>Now let’s apply it to our problem from earlier. The <em>fsolve</em> function takes in several arguments, but for our purposes, we can simply tell it the name of the function to evaluate from earlier, and a list containing our two initial guesses and see what it comes up with:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fsolve</span><span class="p">(</span><span class="n">fnr</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.38196601, 2.61803399])
</pre></div>
</div>
</div>
</div>
<p>Once more we’ve quickly identified the roots of the equation <span class="math notranslate nohighlight">\(x^2-3x+1=0\)</span>. There are other root finding methods that we don’t have time to cover in this course, but all have positive and negative attributes depending on their application.</p>
</div>
<div class="section" id="other-examples">
<h2>Other Examples:<a class="headerlink" href="#other-examples" title="Permalink to this headline">¶</a></h2>
<p><strong>TRY IT!</strong> <span class="math notranslate nohighlight">\(\sqrt{2}\)</span> is the root of the function <span class="math notranslate nohighlight">\(f(x) = x^2 - 2\)</span>. Using <span class="math notranslate nohighlight">\(x_0 = 1.4\)</span> as a starting point, use the information you’ve seen in this worksheet to estimate <span class="math notranslate nohighlight">\(\sqrt{2}\)</span>. Can you recycle some of the earlier algorithmns to do the hard work for you?</p>
<p>Compare this approximation with the value computed by Python’s sqrt function.</p>
<div class="math notranslate nohighlight">
\[
x = 1.4 - \frac{1.4^2 - 2}{2(1.4)} = 1.4142857142857144
\]</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="MAT301_Python_Intro.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Introduction to Python</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="MAT301_Numerical_Integration.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Numerical Integration</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By James Threlfall<br/>
    
        &copy; Copyright 2023.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>