
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Numerical Integration &#8212; MAT301 Numerical Methods</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Differential Equation Solving 1" href="MAT301_DifferentialEquationSolving1.html" />
    <link rel="prev" title="Iterative Solutions to Equations" href="MAT301_Iterative_Techniques.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/Abertay_Uni_Black.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">MAT301 Numerical Methods</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Welcome to MAT301 Numerical Methods with Python
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="MAT301_Python_Intro.html">
   Introduction to Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="MAT301_Iterative_Techniques.html">
   Iterative Solutions to Equations
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Numerical Integration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="MAT301_DifferentialEquationSolving1.html">
   Differential Equation Solving 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="MAT301_DifferentialEquationSolving2.html">
   Differential Equation Solving 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="MAT301_DifferentialEquationSolving3.html">
   Differential Equation Solving 3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="outro.html">
   Summary
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/MAT301_Numerical_Integration.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/jwt104/MAT301NumericalTechniques"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/jwt104/MAT301NumericalTechniques/issues/new?title=Issue%20on%20page%20%2FMAT301_Numerical_Integration.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/jwt104/MAT301NumericalTechniques/master?urlpath=lab/tree/MAT301_Numerical_Integration.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/jwt104/MAT301NumericalTechniques/blob/master/MAT301_Numerical_Integration.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#motivation">
   Motivation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#setting-up-libraries">
     Setting up Libraries
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#trapezium-rule">
   1. Trapezium Rule
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simpson-s-rule">
   Simpson’s Rule
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#other-methods">
   Other methods
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Numerical Integration</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#motivation">
   Motivation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#setting-up-libraries">
     Setting up Libraries
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#trapezium-rule">
   1. Trapezium Rule
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simpson-s-rule">
   Simpson’s Rule
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#other-methods">
   Other methods
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="numerical-integration">
<h1>Numerical Integration<a class="headerlink" href="#numerical-integration" title="Permalink to this headline">¶</a></h1>
<p>Notebook to implement Euler, Midpoint and Euler Trapezium methods to solve differential equations. Designed to support Abertay University undergrad course MAT301 (JT, 2022).</p>
<div class="section" id="motivation">
<h2>Motivation<a class="headerlink" href="#motivation" title="Permalink to this headline">¶</a></h2>
<p>Many laws of motion (for example Newton’s Laws) require differentiation or integration in order to extract different information. For example: integrating a displacement in time yields a velocity. The ability to integrate functions between two points is extremely useful in video games programming.</p>
<p>Given a function <span class="math notranslate nohighlight">\(f(x)\)</span>, we want to approximate the integral of <span class="math notranslate nohighlight">\(f(x)\)</span> over the total <strong>interval</strong>, <span class="math notranslate nohighlight">\([a,b]\)</span>. The following figure illustrates the area this generates.</p>
<img src="https://pythonnumericalmethods.berkeley.edu/_images/21.01.1-Illustration_integral.png" alt="Illustration integral" title="Illustration of the integral. The integral from a to b of the function f is the area below the curve (shaded in grey)." width="400"/>
<p>To achieve this, we assume that the interval is broken up (“discretised”). Our independent variable, <span class="math notranslate nohighlight">\(x\)</span>, will comprise <span class="math notranslate nohighlight">\(N+1\)</span> points with spacing, <span class="math notranslate nohighlight">\(h = \dfrac{b - a}{n}\)</span>.</p>
<p>We denote each point in <span class="math notranslate nohighlight">\(x\)</span> using the subscript “n”, i.e. <span class="math notranslate nohighlight">\(x_n\)</span> (which is common for this type of algorithm), beginning with 0 (<span class="math notranslate nohighlight">\(x_0 = a\)</span>) and ending with n (<span class="math notranslate nohighlight">\(x_n = b\)</span>). Note: There are <span class="math notranslate nohighlight">\(N+1\)</span> grid points because the count starts at <span class="math notranslate nohighlight">\(x_0\)</span>. We also assume we have a function, <span class="math notranslate nohighlight">\(f(x)\)</span>, that can be computed for any of the grid points, or that we have been given the function implicitly as <span class="math notranslate nohighlight">\(f(x_n)\)</span>. The interval <span class="math notranslate nohighlight">\([x_n, x_{n+1}]\)</span> is referred to as a <strong>subinterval</strong>.</p>
<p>Several methods exist to approximate the area under the function or <span class="math notranslate nohighlight">\(\int_a^b f(x) dx\)</span>. Each method approximates the area under <span class="math notranslate nohighlight">\(f(x)\)</span> for each subinterval by a shape for which it is easy to compute the exact area, and then sums the area contributions of every subinterval. In MAT301 we learned about Simpson’s Rule and Trapezium Rule, which we will detail below.</p>
<div class="section" id="setting-up-libraries">
<h3>Setting up Libraries<a class="headerlink" href="#setting-up-libraries" title="Permalink to this headline">¶</a></h3>
<p>As always, we’ll make use of some clever Python tools for plotting and maths, so our first step is to load in the libraries that store these tools:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">math</span> 
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="o">!{</span>sys.executable<span class="o">}</span> -m pip install termcolor
<span class="kn">from</span> <span class="nn">termcolor</span> <span class="kn">import</span> <span class="n">colored</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>zsh:1: parse error near `-m&#39;
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="trapezium-rule">
<h2>1. Trapezium Rule<a class="headerlink" href="#trapezium-rule" title="Permalink to this headline">¶</a></h2>
<p>The <strong>Trapezium Rule</strong> fits each subinterval with a trapezium and sums the areas of each trapezium to approximate the total integral. This approximation for the integral to an arbitrary function is shown in the following figure.</p>
<img src="https://pythonnumericalmethods.berkeley.edu/_images/21.03.1-Trapezoid_integral.png" alt="Trapezoid integral" title="Illustration of the trapezoid integral procedure. The area below the curve is approximated by a summation of trapezoids that approximate the function." width="400"/>
<p>For each subinterval, the Trapezium Rule computes the area of a trapezium with corners at <span class="math notranslate nohighlight">\((x_n, 0), (x_{n+1}, 0), (x_n, f(x_n))\)</span>, and <span class="math notranslate nohighlight">\((x_{n+1}, f(x_{n+1}))\)</span>, which is <span class="math notranslate nohighlight">\(h\frac{f(x_n) + f(x_{n+1})}{2}\)</span>. Thus, the Trapezium Rule approximates integrals according to the expression</p>
<div class="math notranslate nohighlight">
\[
\int_a^b f(x)~{\rm d}x \approx \sum_{n=0}^{N-1} h\frac{f(x_n) + f(x_{n+1})}{2}.
\]</div>
<p>In the lectures you should have noted that the Trapezium Rule “double-counts” most of the terms in the series. To illustrate this fact, consider the expansion of the Trapezium Rule:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\sum_{i=0}^{N-1} h\left(\frac{f(x_n) + f(x_{n+1})}{2}\right) = &amp;\frac{h}{2}\left[\left( f(x_0) + f(x_1)\right) + \left(f(x_1) + f(x_2)\right) + \right. \\
&amp;\left. \left(f(x_2) + f(x_3) \right) + \cdots + \left(f(x_{N-1}) + f(x_N)\right)\right].
\end{align}
\end{split}\]</div>
<p>This results in lots of calls to <span class="math notranslate nohighlight">\(f(x)\)</span> than is strictly necessary; we can be more computationally efficient using the following expression:</p>
<div class="math notranslate nohighlight">
\[
\int_a^b f(x)~{\rm d}x \approx \frac{h}{2} \left(f(x_0) + 2 \left(\sum_{i=1}^{N-1} f(x_n)\right) + f(x_N)\right).
\]</div>
<p>In the lectures, we examined the Trapezium rule in Example 8.1 using the integral equation</p>
<div class="math notranslate nohighlight">
\[
\int_0^1{\frac{\rm{d}x}{1+x^2}},
\]</div>
<p>where we were asked to use four strips and work to 5 decimal places.</p>
<p>To evaluate the problem, we broke up the range of integration into strips, evaluated the function at each of the edges of each strip, then applied the formula above to determine the total area under the curve. We’ll do the same thing here numerically.</p>
<p>First, we’ll define a Python function which returns the value of the function to be integrated at any given point in <span class="math notranslate nohighlight">\(x\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">result</span><span class="o">=</span><span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span> <span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
</div>
</div>
<p>Next, we’ll define some useful parameters, like the upper and lower limit of integration and use these to determine the step size <span class="math notranslate nohighlight">\(h\)</span> using the formula we learned in the lectures:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">b</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;step size h: &quot;</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>step size h:  0.25
</pre></div>
</div>
</div>
</div>
<p>To evaluate the integral, we need to evaluate the function at each step along the interval between <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span>. We therefore need to calculate the values of <span class="math notranslate nohighlight">\(x\)</span> to pipe into our function.</p>
<p>I will use a package function called <em>np.arange</em>, but this function returns all of the steps <strong>except</strong> the final step, hence when I call the function, I ask for values in the range from <span class="math notranslate nohighlight">\(a\)</span> to <span class="math notranslate nohighlight">\((b+h)\)</span> so that the function returns values between <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> and omits a value I didn’t want anyway!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.   0.25 0.5  0.75 1.  ]
</pre></div>
</div>
</div>
</div>
<p>Now that the <span class="math notranslate nohighlight">\(x\)</span>-range looks good, we can evaluate our function at each position, then carry out the sum according to the Trapezium Rule:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">f1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">total_trap_area</span> <span class="o">=</span> <span class="n">h</span> <span class="o">*</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">f</span><span class="p">[</span><span class="n">N</span><span class="p">])</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;total area (trapezium): &quot;</span><span class="p">,</span> <span class="n">total_trap_area</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>total area (trapezium):  0.7827941176470589
</pre></div>
</div>
</div>
</div>
<p>This was the value we calculated in the lectures by hand. Remember, we also identified that this integral had an exact solution: <span class="math notranslate nohighlight">\(\pi/4\)</span>.</p>
<p>The error in the Trapezium rule for this many strips and for this function can therefore be calculated by subtracting the approximation from the true value (using the absolute value in case the approximation yields an over-estimate):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">err_trap</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="mf">0.25</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="n">total_trap_area</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;error in trapezium: &quot;</span><span class="p">,</span> <span class="n">err_trap</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>error in trapezium:  0.0026040457503894165
</pre></div>
</div>
</div>
</div>
<p><strong>Try for yourself:</strong> Repeat the calculation above, but crank up the number of strips. What happens?</p>
<p>(Careful not to ask for too many strips or the calculation speed may decrease!)</p>
</div>
<div class="section" id="simpson-s-rule">
<h2>Simpson’s Rule<a class="headerlink" href="#simpson-s-rule" title="Permalink to this headline">¶</a></h2>
<p>We also learned about a second approximate method to approximate finite integrals; Simpon’s Rule.</p>
<p>Consider <em>two</em> consecutive subintervals, <span class="math notranslate nohighlight">\([x_{n-1}, x_n]\)</span> and <span class="math notranslate nohighlight">\([x_n, x_{n+1}]\)</span>. <strong>Simpson’s Rule</strong> approximates the area under <span class="math notranslate nohighlight">\(f(x)\)</span> over these two subintervals by fitting a quadratic polynomial through the points <span class="math notranslate nohighlight">\((x_{n-1}, f(x_{n-1})), (x_n, f(x_n))\)</span>, and <span class="math notranslate nohighlight">\((x_{n+1}, f(x_{n+1}))\)</span>, and then integrating the quadratic exactly. The following shows this integral approximation for an arbitrary function.</p>
<img src="https://pythonnumericalmethods.berkeley.edu/_images/21.04.1-Simpson_integral.png" alt="Simpsons integral" title="Illustration of the Simpson integral formula. Discretization points are grouped by three, and a parabola is fit between the three points. This can be done by a typical interpolation polynomial. The area under the curve is approximated by the area under the parabola." width="550"/>
<p>Quadratic polynomial approximation takes place over two sub-intervals. With some algebra and manipulation, and combining (integrating) various polynomials together, we arrive at the the formula</p>
<div class="math notranslate nohighlight">
\[
\int_a^b f(x)~{\rm d}x \approx \frac{h}{3} \left[f(x_0)+4 \left(\sum_{n=1, n\  {\text{odd}}}^{N-1}f(x_n)\right)+2 \left(\sum_{n=2, n\  {\text{even}}}^{N-2}f(x_n)\right)+f(x_N)\right].
\]</div>
<p><strong>WARNING!</strong> Remember that Simpson’s Rule <strong>must</strong> be used for an even number of intervals and, therefore, an odd number of grid points.</p>
<p>We can illustrate how Simpson’s rule works, first by recycling the simple problem attacked earlier using the trapezium rule. We have already defined all the necessary components (limits, step size and values of <span class="math notranslate nohighlight">\(x\)</span>) that we will need. Let’s first check that we’re okay to apply Simpson’s rule; to do this, we need to check if our total number of steps <span class="math notranslate nohighlight">\(n\)</span> is even:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">N</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;WARNING: N EVEN - Simpsons rule will FAIL&#39;</span><span class="p">)</span> <span class="c1"># Odd </span>
</pre></div>
</div>
</div>
</div>
<p>No warning appeared so we’re good to go. All we need to do is sum the elements that we’ve calculated according to the Simpson’s rule formula. We can be a bit clever here, and let Python decide which numbers are odd and which are even (by picking every second element in cleverly chosen ranges which omit <span class="math notranslate nohighlight">\(f_0\)</span> and <span class="math notranslate nohighlight">\(f_n\)</span> (used elsewhere in the formula.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">total_simp_area</span> <span class="o">=</span> <span class="n">h</span> <span class="o">/</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="p">(</span> <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">f</span><span class="p">[</span><span class="n">N</span><span class="p">]</span> <span class="o">+</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;total area (Simpson&#39;s Rule):&quot;</span><span class="p">,</span> <span class="n">total_simp_area</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>total area (Simpson&#39;s Rule): 0.785392156862745
</pre></div>
</div>
</div>
</div>
<p>This number again looks very similar to the one derived by the Trapezium rule, but let’s evaluate the error in it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">err_simp</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="mf">0.25</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="n">total_simp_area</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;error in Simpsons rule&#39;</span><span class="p">,</span> <span class="n">err_simp</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;error in Trapezium rule&#39;</span><span class="p">,</span> <span class="n">err_trap</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>error in Simpsons rule 6.006534703284494e-06
error in Trapezium rule 0.0026040457503894165
</pre></div>
</div>
</div>
</div>
<p>The error in the Simpson’s rule implementation for this function (and number of strips) is much smaller than that of the Trapezium rule by around 3 orders of magnitude.</p>
</div>
<div class="section" id="other-methods">
<h2>Other methods<a class="headerlink" href="#other-methods" title="Permalink to this headline">¶</a></h2>
<p>Python has an entire library of useful tools for these types of problems, including the ability to evaluate the trapezium method in a single line using <em>trapz</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">trapz</span>
<span class="n">area_trapz</span> <span class="o">=</span> <span class="n">trapz</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;TRAPZ: area=&#39;</span><span class="p">,</span> <span class="n">area_trapz</span><span class="p">,</span> <span class="s1">&#39;, error=&#39;</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="mf">0.25</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="n">area_trapz</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TRAPZ: area= 0.782794117647059 , error= 0.0026040457503893055
</pre></div>
</div>
</div>
</div>
<p>Note that the error in the area from <em>trapz</em> is identical to that we found earlier creating this method manually.</p>
<p>There are a few other numerical integration methods. Try <em>quad</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">quad</span>
<span class="n">area_quad</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">quad</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;QUAD: area=&#39;</span><span class="p">,</span> <span class="n">area_quad</span><span class="p">,</span> <span class="s1">&#39;, error=&#39;</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="mf">0.25</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="n">area_quad</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>QUAD: area=
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 0.7853981633974484 , error= 1.1102230246251565e-16
</pre></div>
</div>
</div>
</div>
<p>Now that you’ve seen one example of an integral performed using numerical techniques in Python, try some of the other worked examples in the lectures, or indeed some of the tutorial question <strong>once you have done them by hand first</strong>.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="MAT301_Iterative_Techniques.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Iterative Solutions to Equations</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="MAT301_DifferentialEquationSolving1.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Differential Equation Solving 1</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By James Threlfall<br/>
    
        &copy; Copyright 2023.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>